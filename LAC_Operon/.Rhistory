library(tidyverse)
library(broom)
options(scipen=999)
import_data <- read_csv("results/Starting conditions scan 2022-11-14 00:33:10.csv") %>%
mutate(across(c(Model, Starting_Conditions_Set, L), as.factor))
import_data %>% head()
import_data %>% glimpse()
data <-
import_data %>%
pivot_longer(cols=c(M, B, A), names_to="Species", values_to="Concentration") %>%
mutate(Species = as.factor(Species)) %>%
nest(data=c(Time, Species, Concentration))
data %>%
filter(Model == "Corrected") %>%
unnest(data) %>%
ggplot(aes(x=Time, y=Concentration, color=Starting_Conditions_Set)) +
geom_line(show.legend=F) +
facet_grid(Species~L, scales="free_y") +
scale_y_log10() +
labs(title="Time progression curves for the three species for different Lactose concentrations [nM]") +
xlab("Time [min]") +
ylab("Concentration [nM]") +
theme_classic()
data %>%
unnest(data) %>%
group_by(Species) %>%
nest() %>%
mutate(F_test = map(data, ~ aov(Concentration ~ Model + Time + L + Starting_Conditions_Set, data = .x) %>% tidy() %>% pluck("p.value", 1))) %>%
unnest(F_test)
data %>% pluck("data", 1, "Time")
end_time <. max(data %>% pluck("data", 1, "Time"))
end_time <- max(data %>% pluck("data", 1, "Time"))
data %>%
unnest(data)
data %>%
unnest(data) %>%
filter(Time == end_time)
data %>%
unnest(data) %>%
filter(Time == end_time) %>%
ggplot(aes(x=Species, y=Concentration)) +
geom_jitter(alpha=0.5) +
theme_classic()
data %>%
unnest(data) %>%
filter(Time == end_time)
data %>%
unnest(data) %>%
filter(Time == end_time) %>%
ggplot(aes(x=Species, y=Concentration)) +
geom_jitter() +
theme_classic()
data %>%
unnest(data) %>%
filter(Time == end_time) %>%
ggplot(aes(x=Species, y=Concentration, color=L)) +
geom_jitter() +
theme_classic()
data %>%
unnest(data) %>%
filter(Time == end_time)
end_time <- max(data %>% pluck("data", 1, "Time"))
data %>%
unnest(data) %>%
filter(Time == end_time) %>%
ggplot(aes(x=Species, y=Concentration, color=L)) +
geom_boxplot() +
theme_classic()
end_time <- max(data %>% pluck("data", 1, "Time"))
data %>%
unnest(data) %>%
filter(Time == end_time) %>%
ggplot(aes(x=Species, y=Concentration)) +
geom_boxplot() +
theme_classic()
end_time <- max(data %>% pluck("data", 1, "Time"))
data %>%
unnest(data) %>%
filter(Time == end_time) %>%
ggplot(aes(x=Species, y=Concentration)) +
geom_boxplot()
data %>%
unnest(data) %>%
filter(Time == end_time)
end_time <- max(data %>% pluck("data", 1, "Time"))
data %>%
unnest(data) %>%
filter(Time == end_time) %>%
ggplot(aes(x=Species, y=Concentration)) +
geom_bar(stat="count")
end_time <- max(data %>% pluck("data", 1, "Time"))
data %>%
unnest(data) %>%
filter(Time == end_time) %>%
ggplot(aes(x=Species)) +
geom_bar(stat="count")
end_time <- max(data %>% pluck("data", 1, "Time"))
data %>%
unnest(data) %>%
filter(Time == end_time) %>%
ggplot(aes(x=Species, y=Concentration)) +
geom_jitter()
end_time <- max(data %>% pluck("data", 1, "Time"))
data %>%
unnest(data) %>%
filter(Time == end_time) %>%
ggplot(aes(x=Species, y=Concentration)) +
geom_point()
end_time <- max(data %>% pluck("data", 1, "Time"))
data %>%
unnest(data) %>%
filter(Time == end_time) %>%
ggplot(aes(x=Species, y=Concentration)) +
geom_dotplot()
end_time <- max(data %>% pluck("data", 1, "Time"))
data %>%
unnest(data) %>%
filter(Time == end_time) %>%
ggplot(aes(x=Species, y=Concentration)) +
geom_boxplot()
end_time <- max(data %>% pluck("data", 1, "Time"))
data %>%
unnest(data) %>%
filter(Time == end_time) %>%
ggplot(aes(x=Species, y=Concentration)) +
geom_boxplot()
data %>%
unnest(data) %>%
filter(Time == end_time) %>%
ggplot(aes(x=Time, y=Concentration)) +
geom_point()
data %>%
unnest(data) %>%
filter(Time == end_time)
data %>%
filter(Model == "Corrected") %>%
unnest(data) %>%
ggplot(aes(x=Time, y=Concentration, color=Starting_Conditions_Set)) +
geom_line(show.legend=F) +
facet_grid(Species~L, scales="free_y") +
#scale_y_log10() +
labs(title="Time progression curves for the three species for different Lactose concentrations [nM]") +
xlab("Time [min]") +
ylab("Concentration [nM]") +
theme_classic()
